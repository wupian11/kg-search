"""
实体抽取提示词模板

针对文博领域优化的实体抽取提示词
"""

# ============================================================
# 实体类型定义 - 文物领域
# ============================================================

ENTITY_TYPES = """
## 核心实体类型

### 文物类
- 文物: 具体的文物藏品，包含艺术作品、图书文献、生活器物、考古标本等
- 资产类型: 文物分类代码，如G1艺术作品、G2生活及仪礼器物、G3图书文献及影音资料
- 资产等级: 国宝、重要古物、一般古物等分级

### 时间类
- 年代: 文物的制作或创建年代，支持以下格式：
  * 西元纪年：如西元1932年、公元前1600年
  * 日治时期：如明治39年、大正5年、昭和7年
  * 民国纪年：如民國65年
  * 朝代：如清同治九年、清光緒年間
- 朝代: 历史朝代，如清、日治時期、民國等

### 地理类
- 行政区: 城市与区域，格式为「縣市名+區名」，如臺北市中正區、嘉義市東區
- 地址: 具体街道地址，如延平南路98號
- 出土地点: 考古发掘地点

### 材质工艺类
- 材质: 文物的制作材料，如紙質、銅、安山岩、玉、陶瓷、錄影帶、木、布等
- 工艺: 制作工艺技术，如鑄造、雕刻、燒製、膠裝、印刷等
- 尺寸: 文物规格，如「長18.6公分 寬12.8公分 厚4.2公分」

### 机构组织类
- 保管单位: 负责保管文物的机构，如財團法人嘉義市文化基金會、臺北市中山堂管理所
- 存放空间: 文物存放的空间类型，如博物館、圖書館、古蹟、公務設施、寺廟、戶外空間
- 公告机关: 登录公告的政府单位，如嘉義市政府、臺北市政府
- 主管机关: 业务主管单位，如嘉義市政府文化局、臺北市立文獻館

### 人物类
- 人物: 与文物相关的人物
  * 创作者/作者：如蒲添生、湯川充雄
  * 历史人物：如孫中山
  * 捐赠者/收藏家

### 法规标准类
- 判定标准: 文物价值判定标准，如：
  * 具有歷史意義或能表現傳統、族群或地方文化特色
  * 具有史事淵源
  * 具有一定之時代特色、技術及流派
  * 具有藝術造詣或科學成就
  * 具有珍貴及稀有性者
  * 具有歷史、文化、藝術或科學價值
- 法规: 相关法律条文，如《文化資產保存法》、《古物分級指定及廢止審查辦法》

### 事件类
- 事件: 与文物相关的历史事件，如登錄、指定、修復、出土、發現等
- 来源方式: 文物取得方式，如購藏(徵集)、既存(繼承)、捐贈等
"""

# 简体中文版本（用于处理简体输入）
ENTITY_TYPES_SIMPLIFIED = """
## 核心实体类型

### 文物类
- 文物: 具体的文物藏品，包含艺术作品、图书文献、生活器物、考古标本等
- 资产类型: 文物分类代码，如G1艺术作品、G2生活及仪礼器物、G3图书文献及影音资料
- 资产等级: 国宝、重要古物、一般古物等分级

### 时间类
- 年代: 文物的制作或创建年代
- 朝代: 历史朝代

### 地理类
- 行政区: 城市与区域
- 地址: 具体街道地址
- 出土地点: 考古发掘地点

### 材质工艺类
- 材质: 文物的制作材料
- 工艺: 制作工艺技术
- 尺寸: 文物规格

### 机构组织类
- 保管单位: 负责保管文物的机构
- 存放空间: 文物存放的空间类型
- 公告机关: 登录公告的政府单位
- 主管机关: 业务主管单位

### 人物类
- 人物: 创作者、历史人物、捐赠者等

### 法规标准类
- 判定标准: 文物价值判定标准
- 法规: 相关法律条文

### 事件类
- 事件: 登录、指定、修复、出土、发现等
- 来源方式: 购藏、既存、捐赠等
"""

# ============================================================
# 繁简转换映射表
# ============================================================

TRADITIONAL_TO_SIMPLIFIED = {
    "臺": "台",
    "臺灣": "台湾",
    "臺北": "台北",
    "臺南": "台南",
    "歷史": "历史",
    "藝術": "艺术",
    "價值": "价值",
    "區": "区",
    "圖書": "图书",
    "館": "馆",
    "寶": "宝",
    "發現": "发现",
    "鑄造": "铸造",
    "陶瓷": "陶瓷",
    "銅": "铜",
    "紙質": "纸质",
    "國": "国",
    "稀有": "稀有",
    "傳統": "传统",
    "時期": "时期",
    "機構": "机构",
    "單位": "单位",
    "資產": "资产",
    "類型": "类型",
}

SIMPLIFIED_TO_TRADITIONAL = {v: k for k, v in TRADITIONAL_TO_SIMPLIFIED.items()}

# ============================================================
# 年代标准化映射
# ============================================================

# 日治时期年号转西元（基准年）
JAPANESE_ERA_BASE = {
    "明治": 1868,  # 明治元年 = 1868
    "大正": 1912,  # 大正元年 = 1912
    "昭和": 1926,  # 昭和元年 = 1926
}

# 民国纪年基准
MINGUO_BASE = 1911  # 民国元年 = 1912, 所以 民国N年 = 1911 + N

# ============================================================
# 实体抽取提示词模板
# ============================================================

ENTITY_EXTRACTION_PROMPT = """你是一个专业的文博领域知识抽取专家，专精于台湾文化资产数据处理。请从以下文本中提取所有相关实体。

## 实体类型说明
{entity_types}

## 输入文本
{text}

## 输出要求
请以JSON格式输出提取的实体，格式如下：
{{
    "entities": [
        {{
            "name": "实体名称（保持原文繁简体）",
            "name_normalized": "标准化名称（统一为繁体）",
            "type": "实体类型（从上述类型中选择）",
            "description": "实体的简要描述",
            "attributes": {{
                "可选的额外属性": "属性值"
            }},
            "source_field": "来源字段名（如caseName, descAge等）",
            "confidence": 0.95
        }}
    ]
}}

## 特殊处理规则

### 年代标准化
提取年代实体时，需在attributes中添加标准化的西元年份：
- 日治明治39年 → attributes.year_ce: 1906
- 日治昭和7年 → attributes.year_ce: 1932
- 民國65年 → attributes.year_ce: 1976
- 清同治九年(1870) → attributes.year_ce: 1870

### 行政区处理
- 从地址中提取城市和区域，如「嘉義市東區忠孝路275號」→ 行政区: 嘉義市東區

### 人物角色
- 在attributes中标注人物角色：creator(创作者)、historical_figure(历史人物)、donor(捐赠者)

## 注意事项
1. 只提取文本中明确提到的实体，不要推测
2. 实体名称应保持原文的繁简体形式
3. 同一个实体只需提取一次
4. confidence表示提取的置信度，范围0-1
5. 确保输出是有效的JSON格式
6. source_field用于结果溯源，标注实体来自原始数据的哪个字段

请开始提取："""

# ============================================================
# 结构化字段直接映射的实体抽取模板（用于JSON字段）
# ============================================================

STRUCTURED_ENTITY_EXTRACTION_PROMPT = """你是一个专业的文博领域知识抽取专家。请从以下结构化的文物数据中提取实体。

注意：这是已经结构化的JSON数据，大部分实体可以直接从字段映射获得。
你的任务是从描述性文本字段（如registerReason, reserveStatusDesc）中补充提取隐含的实体。

## 已从结构化字段提取的实体
{existing_entities}

## 需要分析的描述性文本
{description_text}

## 实体类型说明
{entity_types}

## 输出要求
只输出从描述文本中**新发现**的实体，不要重复已提取的实体。
格式同上。

请开始提取："""
